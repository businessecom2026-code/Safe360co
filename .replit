run = "npm install && npm run build && npm run start"
entrypoint = "server.ts"
modules = ["nodejs-18", "web", "nix"]

[nix]
channel = "stable-25_05"

[env]
NODE_ENV = "production"

[deployment]
run = ["sh", "-c", "npm run start"]
build = ["sh", "-c", "npm install && npm run build"]
deploymentTarget = "cloudrun"

[[ports]]
localPort = 3000
externalPort = 80
